#!/bin/bash

set -e

# TODO: command detection

git clone --bare git@github.com:liooil/dotfiles $HOME/.dotfiles
alias dotfiles='/usr/bin/git --git-dir="$HOME/.dotfiles/" --work-tree="$HOME"'
dotfiles config --local status.showUntrackedFiles no

# backup current config
mkdir -p .dotfiles-backup && \
dotfiles checkout 2>&1 | \
  egrep "\s+\." | \
  awk {'print $1'} | \
  xargs -I{} mkdir -p $(dirname {}) && mv {} .dotfiles-backup/{}

